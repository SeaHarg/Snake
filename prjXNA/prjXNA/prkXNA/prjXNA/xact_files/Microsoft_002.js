

Type.registerNamespace("Microsoft.Mtps.Web.UI");Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection=function(){throw Error.invalidOperation()};Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.prototype={Horizontal:0,Vertical:1};Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.registerEnum("Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection",false);Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior=function(element){Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.initializeBase(this,[element]);this._animation=null;this._collapsedSize=0;this._expandedSize=0;this._scrollContents=null;this._collapsed=false;this._expandControlID=null;this._collapseControlID=null;this._textLabelID=null;this._collapsedText=null;this._expandedText=null;this._imageControlID=null;this._expandedCss=null;this._collapsedCss=null;this._suppressPostBack=null;this._autoExpand=null;this._autoCollapse=null;this._expandDirection=Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical;this._collapseClickHandler=null;this._expandClickHandler=null;this._mouseEnterHandler=null;this._mouseLeaveHandler=null;this._parentDiv=null};Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.prototype={initialize:function(){Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.callBaseMethod(this,"initialize");var element=this.get_element();element.style.display="block";this._animation=new AjaxControlToolkit.Animation.LengthAnimation(element,.1,10,"style",null,0,0,"px");if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical)this._animation.set_propertyKey("height");else if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Horizontal)this._animation.set_propertyKey("width");this._animation.add_ended(Function.createDelegate(this,this._onAnimateComplete));if(this._suppressPostBack==null)if(element.tagName=="INPUT"&&element.type=="checkbox"){this._suppressPostBack=false;this.raisePropertyChanged("SuppressPostBack")}else if(element.tagName=="A"){this._suppressPostBack=true;this.raisePropertyChanged("SuppressPostBack")}var lastState=Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.callBaseMethod(this,"get_ClientState");if(lastState&&lastState!=""){var wasCollapsed=Boolean.parse(lastState);if(this._collapsed!=wasCollapsed){this._collapsed=wasCollapsed;this.raisePropertyChanged("Collapsed")}}this._setupParentDiv();if(this._collapsed)this._setTargetSize(this._getCollapsedSize());else this._setTargetSize(this._getExpandedSize());this._setupState(this._collapsed);if(this._collapseControlID==this._expandControlID){this._collapseClickHandler=Function.createDelegate(this,this._toggle);this._expandClickHandler=null}else{this._collapseClickHandler=Function.createDelegate(this,this._doClose);this._expandClickHandler=Function.createDelegate(this,this._doOpen)}if(this._autoExpand){this._mouseEnterHandler=Function.createDelegate(this,this._onMouseEnter);$addHandler(element,"mouseover",this._mouseEnterHandler)}if(this._autoCollapse){this._mouseLeaveHandler=Function.createDelegate(this,this._onMouseLeave);$addHandler(element,"mouseout",this._mouseLeaveHandler)}if(this._collapseControlID){var collapseElement=$get(this._collapseControlID);if(!collapseElement)throw Error.argument("CollapseControlID","Failed to find element '"+this._collapseControlID+"'");else $addHandler(collapseElement,"click",this._collapseClickHandler)}if(this._expandControlID)if(this._expandClickHandler){var expandElement=$get(this._expandControlID);if(!expandElement)throw Error.argument("ExpandControlID","Failed to find element '"+this._expandControlID+"'");else $addHandler(expandElement,"click",this._expandClickHandler)}},dispose:function(){var element=this.get_element();if(this._collapseClickHandler){var collapseElement=this._collapseControlID?$get(this._collapseControlID):null;if(collapseElement)$removeHandler(collapseElement,"click",this._collapseClickHandler);this._collapseClickHandler=null}if(this._expandClickHandler){var expandElement=this._expandControlID?$get(this._expandControlID):null;if(expandElement)$removeHandler(expandElement,"click",this._expandClickHandler);this._expandClickHandler=null}if(this._mouseEnterHandler)$removeHandler(element,"mouseover",this._mouseEnterHandler);if(this._mouseLeaveHandler)$removeHandler(element,"mouseout",this._mouseLeaveHandler);if(this._animation){this._animation.dispose();this._animation=null}Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.callBaseMethod(this,"dispose")},togglePanel:function(eventObj){this._toggle(eventObj)},expandPanel:function(eventObj){this._doOpen(eventObj)},collapsePanel:function(eventObj){this._doClose(eventObj)},_checkCollapseHide:function(){if(this._collapsed||this._getTargetSize()==0){var e=this.get_element(),display=CommonToolkitScripts.getCurrentStyle(e,"display");if(!e.oldDisplay&&display!="none"){e.oldDisplay=display;e.style.display="none"}return true}return false},_doClose:function(eventObj){if(this._animation){this._animation.stop();this._animation.set_startValue(this._getTargetSize());this._animation.set_endValue(this._getCollapsedSize());this._animation.play()}this._setupState(true);if(this._suppressPostBack)if(eventObj&&eventObj.preventDefault)eventObj.preventDefault();else{event.returnValue=false;return false}},_doOpen:function(eventObj){if(this._animation){this._animation.stop();var e=this.get_element();if(this._checkCollapseHide()&&CommonToolkitScripts.getCurrentStyle(e,"display",e.style.display)){if(e.oldDisplay){e.style.display=e.oldDisplay;e.style.height="auto"}else if(e.style.removeAttribute)e.style.removeAttribute("display");else e.style.removeProperty("display");e.oldDisplay=null}this._animation.set_startValue(this._getTargetSize());this._animation.set_endValue(this._getExpandedSize());this._animation.play()}this._setupState(false);if(this._suppressPostBack)if(eventObj&&eventObj.preventDefault)eventObj.preventDefault();else{event.returnValue=false;return false}},_onAnimateComplete:function(){var e=this.get_element();if(!this._collapsed&&!this._expandedSize){e.style.height="auto";this.raisePropertyChanged("TargetHeight")}else this._checkCollapseHide();if(this._collapsed)this.raiseCollapseComplete();else this.raiseExpandComplete()},_onMouseEnter:function(){if(this._autoExpand)this._doOpen()},_onMouseLeave:function(){if(this._autoCollapse)this._doClose()},_getExpandedSize:function(){if(this._expandedSize)return this._expandedSize;if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical)return this._parentDiv.offsetHeight;else if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Horizontal)return this._parentDiv.offsetWidth},_getCollapsedSize:function(){if(this._collapsedSize)return this._collapsedSize;return 0},_getTargetSize:function(){var value;if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical)value=this.get_TargetHeight();else if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Horizontal)value=this.get_TargetWidth();if(value===undefined)value=0;return value},_setTargetSize:function(value){var useSize=this._collapsed||this._expandedSize,e=this.get_element();if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical)if(useSize||value<e.offsetHeight)this.set_TargetHeight(value);else{e.style.height="auto";this.raisePropertyChanged("TargetHeight")}else if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Horizontal)if(useSize||value<e.offsetWidth)this.set_TargetWidth(value);else{e.style.width="auto";this.raisePropertyChanged("TargetWidth")}this._checkCollapseHide()},_setupParentDiv:function(){var startSize=this._getTargetSize(),e=this.get_element();this._parentDiv=e.cloneNode(false);this._parentDiv.id="";while(e.hasChildNodes()){var child=e.childNodes[0];child=e.removeChild(child);this._parentDiv.appendChild(child)}this._parentDiv.style.position="";this._parentDiv.style.border="";this._parentDiv.style.margin="";e.style.padding="";if(this._scrollContents)e.style.overflow="scroll";else if(this._collapsed)e.style.overflow="hidden";else e.style.overflow="visible";if(startSize==this._collapsedSize)if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical)this._parentDiv.style.height="auto";else if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Horizontal)this._parentDiv.style.width="auto";e.appendChild(this._parentDiv);if(this._collapsed)startSize=this._getCollapsedSize();else startSize=this._getExpandedSize();if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical){e.style.height=startSize+"px";e.style.width=CommonToolkitScripts.getCurrentStyle(this._parentDiv,"width");if(!this._expandedSize)e.style.height="auto";else e.style.height=this._expandedSize+"px"}else if(this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Horizontal){e.style.height=CommonToolkitScripts.getCurrentStyle(this._parentDiv,"height");e.style.width=startSize+"px";if(!this._expandedSize)e.style.width="auto";else e.style.width=this._expandedSize+"px"}},_setupState:function(isCollapsed){if(isCollapsed){if(this._textLabelID&&this._collapsedText){var e=$get(this._textLabelID);if(e)e.innerHTML=this._collapsedText}if(this._imageControlID&&this._collapsedCss){var i=$get(this._imageControlID);if(i){i.className=this._collapsedCss;if(this._expandedText||this._collapsedText)i.title=this._collapsedText}}}else{if(this._textLabelID&&this._expandedText){var e=$get(this._textLabelID);if(e)e.innerHTML=this._expandedText}if(this._imageControlID&&this._expandedCss){var i=$get(this._imageControlID);if(i){i.className=this._expandedCss;if(this._expandedText||this._collapsedText)i.title=this._expandedText}}}if(this._collapsed!=isCollapsed){this._collapsed=isCollapsed;this.raisePropertyChanged("Collapsed")}Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.callBaseMethod(this,"set_ClientState",[this._collapsed.toString()])},_toggle:function(eventObj){if(this.get_Collapsed())return this._doOpen(eventObj);else return this._doClose(eventObj)},add_collapseComplete:function(handler){this.get_events().addHandler("collapseComplete",handler)},remove_collapseComplete:function(handler){this.get_events().removeHandler("collapseComplete",handler)},raiseCollapseComplete:function(){var handlers=this.get_events().getHandler("collapseComplete");if(handlers)handlers(this,Sys.EventArgs.Empty)},add_expandComplete:function(handler){this.get_events().addHandler("expandComplete",handler)},remove_expandComplete:function(handler){this.get_events().removeHandler("expandComplete",handler)},raiseExpandComplete:function(){var handlers=this.get_events().getHandler("expandComplete");if(handlers)handlers(this,Sys.EventArgs.Empty)},get_TargetHeight:function(){return this.get_element().offsetHeight},set_TargetHeight:function(value){this.get_element().style.height=value+"px";this.raisePropertyChanged("TargetHeight")},get_TargetWidth:function(){return this.get_element().offsetWidth},set_TargetWidth:function(value){this.get_element().style.width=value+"px";this.raisePropertyChanged("TargetWidth")},get_Collapsed:function(){return this._collapsed},set_Collapsed:function(value){if(this.get_isInitialized()&&this.get_element()&&value!=this.get_Collapsed())this._toggle();else{this._collapsed=value;this.raisePropertyChanged("Collapsed")}},get_CollapsedSize:function(){return this._collapsedSize},set_CollapsedSize:function(value){if(this._collapsedSize!=value){this._collapsedSize=value;this.raisePropertyChanged("CollapsedSize")}},get_ExpandedSize:function(){return this._expandedSize},set_ExpandedSize:function(value){if(this._expandedSize!=value){this._expandedSize=value;this.raisePropertyChanged("ExpandedSize")}},get_CollapseControlID:function(){return this._collapseControlID},set_CollapseControlID:function(value){if(this._collapseControlID!=value){this._collapseControlID=value;this.raisePropertyChanged("CollapseControlID")}},get_ExpandControlID:function(){return this._expandControlID},set_ExpandControlID:function(value){if(this._expandControlID!=value){this._expandControlID=value;this.raisePropertyChanged("ExpandControlID")}},get_ScrollContents:function(){return this._scrollContents},set_ScrollContents:function(value){if(this._scrollContents!=value){this._scrollContents=value;this.raisePropertyChanged("ScrollContents")}},get_SuppressPostBack:function(){return this._suppressPostBack},set_SuppressPostBack:function(value){if(this._suppressPostBack!=value){this._suppressPostBack=value;this.raisePropertyChanged("SuppressPostBack")}},get_TextLabelID:function(){return this._textLabelID},set_TextLabelID:function(value){if(this._textLabelID!=value){this._textLabelID=value;this.raisePropertyChanged("TextLabelID")}},get_ExpandedText:function(){return this._expandedText},set_ExpandedText:function(value){if(this._expandedText!=value){this._expandedText=value;this.raisePropertyChanged("ExpandedText")}},get_CollapsedText:function(){return this._collapsedText},set_CollapsedText:function(value){if(this._collapsedText!=value){this._collapsedText=value;this.raisePropertyChanged("CollapsedText")}},get_ImageControlID:function(){return this._imageControlID},set_ImageControlID:function(value){if(this._imageControlID!=value){this._imageControlID=value;this.raisePropertyChanged("ImageControlID")}},get_ExpandedCss:function(){return this._expandedCss},set_ExpandedCss:function(value){if(this._expandedCss!=value){this._expandedCss=value;this.raisePropertyChanged("ExpandedCss")}},get_CollapsedCss:function(){return this._collapsedCss},set_CollapsedCss:function(value){if(this._collapsedCss!=value){this._collapsedCss=value;this.raisePropertyChanged("CollapsedCss")}},get_AutoExpand:function(){return this._autoExpand},set_AutoExpand:function(value){if(this._autoExpand!=value){this._autoExpand=value;this.raisePropertyChanged("AutoExpand")}},get_AutoCollapse:function(){return this._autoCollapse},set_AutoCollapse:function(value){if(this._autoCollapse!=value){this._autoCollapse=value;this.raisePropertyChanged("AutoCollapse")}},get_ExpandDirection:function(){return this._expandDirection==Microsoft.Mtps.Web.UI.CollapsiblePanelExpandDirection.Vertical},set_ExpandDirection:function(value){if(this._expandDirection!=value){this._expandDirection=value;this.raisePropertyChanged("ExpandDirection")}}};Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior.registerClass("Microsoft.Mtps.Web.UI.CollapsiblePanelBehavior",AjaxControlToolkit.BehaviorBase)

