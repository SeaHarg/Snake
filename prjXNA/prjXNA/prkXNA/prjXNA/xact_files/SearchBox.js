
if (typeof mscom_core_bootstrap === 'undefined') {
mscom_core_bootstrap = true;
mscom_core_baseuri ='http://i4.services.social.microsoft.com:80/Search/';
var delay = 100, maxRetry = 20;

function mscom_core_exec(func, dependsFunc, retry) {
if (retry) retry++; else retry = 1;
if (dependsFunc()) {
func();
} else if (retry <= maxRetry) {
var timeout = delay * retry;
setTimeout(function() {mscom_core_exec(func, dependsFunc, retry);}, timeout);
}
}

function mscom_core_load() {
Type.registerNamespace("mscom.core");mscom.core.JSONhttpRequest=function(src){this.src=src;this.head=document.getElementsByTagName("head")[0]};mscom.core.JSONhttpRequest.prototype={execute:function(){var a=this;a.script=document.createElement("script");a.script.type="text/javascript";a.script.src=a.src+"&rnd"+Math.random();a.head.appendChild(a.script)},dispose:function(){try{this.head.removeChild(this.script)}catch(ex){}}};mscom.core.getVisible=function(element){return element&&"none"!=mscom.core.getCurrentStyle(element,"display")&&"hidden"!=mscom.core.getCurrentStyle(element,"visibility")};mscom.core.setVisible=function(element,value){if(element&&value!=mscom.core.getVisible(element)){if(value)if(element.style.removeAttribute)element.style.removeAttribute("display");else element.style.removeProperty("display");else element.style.display="none";element.style.visibility=value?"visible":"hidden"}};mscom.core.getCurrentStyle=function(element,attribute,defaultValue){var a="undefined",currentValue=null;if(element){if(element.currentStyle)currentValue=element.currentStyle[attribute];else if(document.defaultView&&document.defaultView.getComputedStyle){var style=document.defaultView.getComputedStyle(element,null);if(style)currentValue=style[attribute]}if(!currentValue&&element.style.getPropertyValue)currentValue=element.style.getPropertyValue(attribute);else if(!currentValue&&element.style.getAttribute)currentValue=element.style.getAttribute(attribute)}if(!currentValue||currentValue==""||typeof currentValue===a)if(typeof defaultValue!=a)currentValue=defaultValue;else currentValue=null;return currentValue};mscom.core.getBounds=function(element){var offset=Sys.UI.DomElement.getLocation(element);return new Sys.UI.Bounds(offset.x,offset.y,element.offsetWidth||0,element.offsetHeight||0)};if(typeof mscom.timer==="undefined"){mscom.timer=function(){var a=this;mscom.timer.initializeBase(a);a._interval=1000;a._enabled=false;a._timer=null};mscom.timer.prototype={get_interval:function(){return this._interval},set_interval:function(value){var a=this;if(a._interval!==value){a._interval=value;a.raisePropertyChanged("interval");if(!a.get_isUpdating()&&a._timer!==null){a._stopTimer();a._startTimer()}}},get_enabled:function(){return this._enabled},set_enabled:function(value){var a=this;if(value!==a.get_enabled()){a._enabled=value;a.raisePropertyChanged("enabled");if(!a.get_isUpdating())if(value)a._startTimer();else a._stopTimer()}},add_tick:function(handler){this.get_events().addHandler("tick",handler)},remove_tick:function(handler){this.get_events().removeHandler("tick",handler)},dispose:function(){this.set_enabled(false);this._stopTimer();mscom.timer.callBaseMethod(this,"dispose")},updated:function(){var a=this;mscom.timer.callBaseMethod(a,"updated");if(a._enabled){a._stopTimer();a._startTimer()}},_timerCallback:function(){var handler=this.get_events().getHandler("tick");if(handler)handler(this,Sys.EventArgs.Empty)},_startTimer:function(){var a=this;a._timer=window.setInterval(Function.createDelegate(a,a._timerCallback),a._interval)},_stopTimer:function(){window.clearInterval(this._timer);this._timer=null}};mscom.timer.descriptor={properties:[{name:"interval",type:Number},{name:"enabled",type:Boolean}],events:[{name:"tick"}]};mscom.timer.registerClass("mscom.timer",Sys.Component)}Type.registerNamespace("mscom.srch");mscom_srch_searchBox=true;mscom.srch.searchBoxState=function(){this.userSelectedTermFlag=false;this.userChangedTermAfterSelectFlag=false;this.autocompleteTermsShownFlag=false};mscom.srch.searchBoxState.prototype={userSelectedTerm:function(){this.userSelectedTermFlag=true;this.userChangedTermAfterSelectFlag=false},userChangedTerm:function(){if(this.userSelectedTermFlag)this.userChangedTermAfterSelectFlag=true},autocompleteTermsShown:function(){this.autocompleteTermsShownFlag=true},getInstrumentationValue:function(){var val=0;if(this.userSelectedTermFlag)val=1;if(this.userChangedTermAfterSelectFlag)val=2;if(val===0)val=this.autocompleteTermsShownFlag?3:8;return val}};mscom.srch.searchBox=function(sbData){var a=this;a.sbData=sbData;a.serviceRequestDelay=500;a.searchBoxElement;a.searchButtonElement;a.prescopeButtonElement;a.prescopeListElement;a.termServiceRequest;a.lastTerm;a.completetionListElement;a.maxTerms=10;a.termItems=[];a.selectedTermIndex=-1;a.textBackground="#ffffff";a.textColor="#000000";a.state=new mscom.srch.searchBoxState;a.prescopeItems;a.selectedPrescopeIndex=-1;a.prescopeListElementWidth="150px";a.currentPrescopeId;a.minimumTermLength=4};mscom.srch.searchBox.prototype={loadTermsFromService:function(){var a=this;a.requestTimer.set_enabled(false);var value=a.searchBoxElement.value;if(value.length>=a.minimumTermLength){var uri=a.sbData.serviceUri+"?t="+encodeURIComponent(value)+"&b="+a.sbData.brand+"&l="+a.sbData.loc+"&m="+a.maxTerms;if(a.termServiceRequest)a.termServiceRequest.dispose();a.termServiceRequest=new mscom.core.JSONhttpRequest(uri);a.termServiceRequest.execute()}},updateTerms:function(){var a=this,value=a.searchBoxElement.value;if(!a.searchBoxElement.watermarkShown&&value.length>=a.minimumTermLength)if(value===a.lastTerm){if(a.termItems.length>0)a.showTermsFlyout()}else{a.lastTerm=value;a.requestTimer.set_enabled(true)}else{a.lastTerm="";a.clearTerms();a.hideTermsFlyout()}},clearTerms:function(){this.termItems=[];this.completionListElement.innerHTML="";this.selectedTermIndex=-1},termcb:function(json){var a=this;a.termServiceRequest.dispose();a.clearTerms();if(a.shouldProcessTermResultJson(json)){var terms=json.Matches;for(var i=0;i<terms.length;i++){var itemElement=a.createItemElement(terms[i],json.Term);a.termItems[i]=itemElement;a.completionListElement.appendChild(itemElement)}var elementBounds=mscom.core.getBounds(a.searchBoxElement);a.completionListElement.style.width=Math.max(1,elementBounds.width-6)+"px";a.completionListElement.scrollTop=0;a.state.autocompleteTermsShown();a.showTermsFlyout()}else a.hideTermsFlyout()},shouldProcessTermResultJson:function(json){return json&&json.Matches&&json.Matches.length&&json.Term.toUpperCase()===this.searchBoxElement.value.toUpperCase()&&(json.Matches.length>1||json.Matches[0].toUpperCase()!==this.lastTerm.toUpperCase())},createItemElement:function(text,highliteText){var itemElement=document.createElement("li");if(highliteText){var prefixText=highliteText,beginPrefixIndex=text.toUpperCase().indexOf(prefixText.toUpperCase()),endPrefixIndex=beginPrefixIndex+prefixText.length;if(beginPrefixIndex>0)itemElement.appendChild(document.createTextNode(text.slice(0,beginPrefixIndex)));var strongElement=document.createElement("span");strongElement.style.fontWeight="bold";strongElement.appendChild(document.createTextNode(text.slice(beginPrefixIndex,endPrefixIndex)));itemElement.appendChild(strongElement);if(endPrefixIndex<text.length)itemElement.appendChild(document.createTextNode(text.slice(endPrefixIndex)))}else itemElement.appendChild(document.createTextNode(text));itemElement._value=text;var itemElementStyle=itemElement.style;itemElementStyle.padding="0px";itemElementStyle.textAlign="left";itemElementStyle.textOverflow="ellipsis";itemElementStyle.fontFamily="Verdana, Arial, Helvetica, Sans-Serif";return itemElement},hideTermsFlyout:function(){if(!this.suppressHideTermsFlyout)mscom.core.setVisible(this.completionListElement,false);this.suppressHideTermsFlyout=false},showTermsFlyout:function(){var a=this;mscom.core.setVisible(a.completionListElement,true);var point=a.getFlyoutLocation(a.searchBoxElement,a.completionListElement);Sys.UI.DomElement.setLocation(a.completionListElement,point.x,point.y)},showPrescopeFlyout:function(){var a=this;mscom.core.setVisible(a.prescopeListElement,true);var point=a.getFlyoutLocation(a.prescopeButtonElement,a.prescopeListElement);Sys.UI.DomElement.setLocation(a.prescopeListElement,point.x,point.y)},hidePrescopeFlyout:function(){mscom.core.setVisible(this.prescopeListElement,false)},getFlyoutLocation:function(parentElement,targetElement){var offsetParent=targetElement.offsetParent||document.documentElement,parentBounds=mscom.core.getBounds(parentElement),offestParentLocation=Sys.UI.DomElement.getLocation(offsetParent);diff={x:parentBounds.x-offestParentLocation.x,y:parentBounds.y-offestParentLocation.y};if(targetElement===this.prescopeListElement){var targetBounds=mscom.core.getBounds(targetElement);diff.x=diff.x-targetBounds.width+parentBounds.width}var point={x:diff.x,y:diff.y+parentBounds.height};return point},showWatermark:function(){var a=this;if(a.shouldShowWatermark()){a.searchBoxElement.watermarkShown=true;a.searchBoxElement.blur();var text=a.sbData.prescopes[0].name;if(a.selectedPrescopeIndex>=0)text=a.sbData.prescopes[a.selectedPrescopeIndex].name;a.searchBoxElement.style.color="#aaaaaa";a.searchBoxElement.style.fontStyle="italic";a.searchBoxElement.value=text}},shouldShowWatermark:function(){var a=this;return a.searchBoxElement.watermarkShown||a.searchBoxElement.value.length==0&&a.sbData.prescopes&&a.sbData.prescopes.length>0||a.searchTextMatchesPrescope()},searchTextMatchesPrescope:function(){var a=this;if(a.sbData.prescopes)for(var i=0;i<a.sbData.prescopes.length;i++)if(a.sbData.prescopes[i].name==a.searchBoxElement.value)return true;return false},hideWatermark:function(){var a=this;if(a.searchBoxElement.watermarkShown){a.searchBoxElement.watermarkShown=false;a.searchBoxElement.value="";a.searchBoxElement.style.color="";a.searchBoxElement.style.fontStyle=""}},onSearchBoxFocus:function(){this.updateTerms();this.hideWatermark()},onSearchBoxBlur:function(){this.hideTermsFlyout();this.showWatermark()},init:function(){var a=this;a.searchBoxElement=$get(a.sbData.boxId);if(a.sbData.maxTerms)a.maxTerms=a.sbData.maxTerms;if(a.paramsValid()&&a.searchBoxElement){a.initEventHandlers();a.initRequestTimer();a.initSearchBoxElement();a.initCompletionList();if(a.sbData.prescopes&&a.sbData.prescopes.length){a.selectedPrescopeIndex=a.getPrescopeFromResRef();a.initPrescopeList();a.initPrescopeButton()}a.showWatermark()}},initPrescopeButton:function(){var a=this;a.prescopeButtonElement=$get(a.sbData.prescopeButtonId);if(a.prescopeButtonElement){a.prescopeButtonElement.onclick=function(){return false};$addHandler(a.prescopeButtonElement,"click",a.prescopeClickHandler);$addHandler(a.prescopeButtonElement,"blur",a.prescopeButtonBlurHandler);$addHandler(a.prescopeButtonElement,"keydown",a.keyDownHandler)}},initEventHandlers:function(){var a=this;a.loadTermsHandler=Function.createDelegate(a,a.loadTermsFromService);a.onSearchBoxFocusHandler=Function.createDelegate(a,a.onSearchBoxFocus);a.searchBoxBlurHandler=Function.createDelegate(a,a.onSearchBoxBlur);a.completionMouseoverHandler=Function.createDelegate(a,a.onListMouseOver);a.completionMouseDownHandler=Function.createDelegate(a,a.onCompletionMouseDown);a.completionMouseUpHandler=Function.createDelegate(a,a.onCompletionMouseUp);a.searchBoxKeyUpHandler=Function.createDelegate(a,a.onSearchBoxKeyUp);a.keyDownHandler=Function.createDelegate(a,a.onKeyDown);a.searchButtonClickHandler=Function.createDelegate(a,a.onSearchButtonClick);a.prescopeClickHandler=Function.createDelegate(a,a.onPrescopeButtonClick);a.prescopeButtonBlurHandler=Function.createDelegate(a,a.onPrescopeButtonBlur);a.prescopeMouseoverHandler=Function.createDelegate(a,a.onListMouseOver);a.prescopeMouseDownHandler=Function.createDelegate(a,a.onPrescopeMouseDown);a.documentKeyUpHandler=Function.createDelegate(a,a.onKeyUp);$addHandler(document,"keyup",a.documentKeyUpHandler)},initRequestTimer:function(){var a=this;a.requestTimer=new mscom.timer;a.requestTimer.set_interval(a.serviceRequestDelay);a.requestTimer.add_tick(a.loadTermsHandler)},initSearchBoxElement:function(){var a=this;a.searchBoxElement.setAttribute("autocomplete","off");a.searchButtonElement=$get(a.sbData.btnId);$addHandler(a.searchBoxElement,"keyup",a.searchBoxKeyUpHandler);$addHandler(a.searchBoxElement,"focus",a.onSearchBoxFocusHandler);$addHandler(a.searchBoxElement,"blur",a.searchBoxBlurHandler);$addHandler(a.searchBoxElement,"keydown",a.keyDownHandler);a.searchButtonElement.onclick=function(){return false};$addHandler(a.searchButtonElement,"click",a.searchButtonClickHandler)},initCompletionList:function(){var a=this;a.completionListElement=a.createFlyoutElement();a.searchBoxElement.parentNode.insertBefore(a.completionListElement,a.searchBoxElement.nextSibling);$addHandler(a.completionListElement,"mousedown",a.completionMouseDownHandler);$addHandler(a.completionListElement,"mouseup",a.completionMouseUpHandler);$addHandler(a.completionListElement,"mouseover",a.completionMouseoverHandler)},initPrescopeList:function(){var a=this;a.prescopeListElement=a.createFlyoutElement();$addHandler(a.prescopeListElement,"mouseover",a.prescopeMouseoverHandler);$addHandler(a.prescopeListElement,"mousedown",a.prescopeMouseDownHandler);a.prescopeItems=[];a.searchBoxElement.parentNode.insertBefore(a.prescopeListElement,a.searchBoxElement.nextSibling);for(var i=0;i<a.sbData.prescopes.length;i++){var itemElement=a.createItemElement(a.sbData.prescopes[i].name);itemElement.refinementId=a.sbData.prescopes[i].refinementId;a.prescopeListElement.appendChild(itemElement);a.prescopeItems[i]=itemElement}a.prescopeListElement.style.width=a.prescopeListElementWidth;a.prescopeListElement.scrollTop=0;a.highlightItem(a.prescopeListElement,a.selectedPrescopeIndex,true);a.updateTitles()},updateTitles:function(){var a=this,selectedPrescopeName=a.sbData.prescopes[a.selectedPrescopeIndex].name;a.searchBoxElement.setAttribute("title",selectedPrescopeName);a.searchButtonElement.setAttribute("title",selectedPrescopeName)},getPrescopeFromResRef:function(){var refQuery=this.sbData.resref;if(refQuery&&refQuery.length){var refinements=refQuery.split(",");if(refinements.length)for(var i=0;i<refinements.length;i++)for(j=0;j<this.sbData.prescopes.length;j++)if(refinements[i]==this.sbData.prescopes[j].refinementId)return j}return 0},paramsValid:function(){var a=this;return a.sbData.brand&&a.sbData.brand.length>0&&a.sbData.loc&&a.sbData.loc.length>0},createFlyoutElement:function(){var element=document.createElement("ul");mscom.core.setVisible(element,false);var style=element.style;style.textAlign="left";style.visibility="hidden";style.cursor="default";style.listStyle="none";style.padding="0px";style.margin="0px! important";style.border="solid 1px buttonshadow";style.position="absolute";style.padding="1px";style.zIndex="1000";this.textBackground="#FFFFFF";style.backgroundColor=this.textBackground;style.color=this.textColor;return element},getFlyoutInfo:function(element){var a=this,listElement,selectedIndex=-1;switch(element){case a.searchBoxElement:case a.completionListElement:listElement=a.completionListElement;selectedIndex=a.selectedTermIndex;break;case a.prescopeButtonElement:case a.prescopeListElement:listElement=a.prescopeListElement;selectedIndex=a.selectedPrescopeIndex}return {listElement:listElement,selectedIndex:selectedIndex}},setFlyoutInfo:function(element,selectedIndex){var a=this;switch(element){case a.searchBoxElement:case a.completionListElement:a.selectedTermIndex=selectedIndex;break;case a.prescopeButtonElement:case a.prescopeListElement:a.selectedPrescopeIndex=selectedIndex}},onPrescopeMouseDown:function(){this.selectCurrentPrescopeItem()},onPrescopeButtonClick:function(){this.showPrescopeFlyout()},onPrescopeButtonBlur:function(){this.hidePrescopeFlyout()},onListMouseOver:function(ev){var element=ev.target,flyoutInfo=this.getFlyoutInfo(element.parentNode);if(!flyoutInfo.listElement){element=element.parentNode;flyoutInfo=this.getFlyoutInfo(element.parentNode)}if(flyoutInfo.listElement){var children=flyoutInfo.listElement.childNodes;for(var i=0;i<children.length;++i)if(element===children[i]){this.highlightItem(flyoutInfo.listElement,i);break}}},onCompletionMouseDown:function(ev){var element=ev.target;if(element!==this.completionListElement){this.suppressHideTermsFlyout=true;if(!element._value)element=element.parentNode;this.setText(element)}},onCompletionMouseUp:function(){this.searchBoxElement.focus()},onKeyUp:function(ev){var k=ev.keyCode?ev.keyCode:ev.rawEvent.keyCode;if(k===Sys.UI.Key.esc){this.hideTermsFlyout();this.hidePrescopeFlyout()}},onSearchBoxKeyUp:function(){var a=this;if(a.lastTerm!==a.searchBoxElement.value)a.state.userChangedTerm();a.updateTerms()},onKeyDown:function(ev){var a=this,k=ev.keyCode?ev.keyCode:ev.rawEvent.keyCode,flyoutInfo=a.getFlyoutInfo(ev.target);if(flyoutInfo.listElement)if(k===Sys.UI.Key.up){if(flyoutInfo.selectedIndex>0){flyoutInfo.selectedIndex--;a.highlightItem(flyoutInfo.listElement,flyoutInfo.selectedIndex);ev.stopPropagation();ev.preventDefault()}}else if(k===Sys.UI.Key.down){if(flyoutInfo.selectedIndex<flyoutInfo.listElement.childNodes.length-1){flyoutInfo.selectedIndex++;a.highlightItem(flyoutInfo.listElement,flyoutInfo.selectedIndex);ev.stopPropagation();ev.preventDefault()}}else if(k===Sys.UI.Key.enter){if(flyoutInfo.listElement===a.completionListElement&&flyoutInfo.selectedIndex!==-1)a.setText(a.completionListElement.childNodes[a.selectedTermIndex]);else if(flyoutInfo.listElement===a.prescopeListElement){if(a.selectedPrescopeIndex>=0)a.selectCurrentPrescopeItem();a.showPrescopeFlyout()}else a.executeSearch();ev.stopPropagation();ev.preventDefault()}},onSearchButtonClick:function(){this.executeSearch()},executeSearch:function(){var a=this;if(a.searchBoxElement.watermarkShown||a.searchBoxElement.value.trim().length==0)return;a.searchButtonElement.focus();var location=a.sbData.searchLocation+a.sbData.loc+"/?query="+encodeURIComponent(a.searchBoxElement.value),refinementQueryParam=a.createRefinementQueryParameter();if(refinementQueryParam)location+=refinementQueryParam;var locovr=a.sbData.locovr;if(locovr&&locovr.length)location+="&resultsLang="+locovr;var addEnglish=a.sbData.addEnglish;if(addEnglish&&addEnglish.length)location+="&addEnglish="+addEnglish;var instrumentationValue=a.state.getInstrumentationValue();if(instrumentationValue>0)location+="&ac="+instrumentationValue;window.location=location},createRefinementQueryParameter:function(){var refinements=this.sbData.resref,refinementParamName="&refinement=",refinementParam;if(this.currentPrescopeId)refinements=this.currentPrescopeId.toString();if(refinements&&refinements.length&&refinements!="0")refinementParam=refinementParamName+refinements;return refinementParam},selectCurrentPrescopeItem:function(){var a=this;a.currentPrescopeId=a.sbData.prescopes[a.selectedPrescopeIndex].refinementId;a.highlightItem(a.prescopeListElement,a.selectedPrescopeIndex,true);a.updateTitles();a.showWatermark();a.executeSearch()},highlightItem:function(listElement,idx,bold){this.setFlyoutInfo(listElement,idx);var children=listElement.childNodes,item=children[idx];for(var i=0;i<children.length;i++){var child=children[i];child.style.backgroundColor=this.textBackground;child.style.color=this.textColor;if(bold)child.style.fontWeight=""}if(bold)item.style.fontWeight="bold";else{item.style.backgroundColor="highlight";item.style.color="highlighttext"}},setText:function(item){if(item&&item._value){this.state.userSelectedTerm();var text=item._value;this.searchBoxElement.value=text;this.updateTerms()}}};mscom.srch.termcb=function(json){mscom.srch.searchBoxInstance.termcb(json)}
}

function mscom_core_init() {
var searchBoxData = {"addEnglish":null,"boxId":"ctl00_Masthead1_ctl00_SearchTextBox","brand":"Msdn","btnId":"ctl00_Masthead1_ctl00_SearchButton","loc":"en-US","locovr":null,"maxTerms":null,"prescopeButtonId":null,"prescopes":[{"name":"Search MSDN with Live Search","refinementId":"0"},{"name":"Search Microsoft.com with Live Search","refinementId":"105"},{"name":"Search Entire Web with Live Search","refinementId":"115"}],"resref":null,"searchLocation":"http:\/\/social.Msdn.microsoft.com\/Search\/","serviceUri":"http:\/\/services.social.microsoft.com\/Search\/Data\/AutoCompleteTerms"}; 
mscom.srch.searchBoxInstance = new mscom.srch.searchBox(searchBoxData); 
mscom.srch.searchBoxInstance.init();
}

mscom_core_exec(function() {mscom_core_load()}, function() {return typeof(Sys) !== 'undefined';});
mscom_core_exec(function() {mscom_core_init()}, function() {return typeof(mscom_srch_searchBox) !== 'undefined'});

}